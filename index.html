
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <!-- 
        ============================================================
        【移动端适配设置】
        - width=device-width: 宽度等于设备宽度
        - initial-scale=1.0: 初始缩放比例为1
        - maximum-scale=1.0: 最大缩放比例为1
        - user-scalable=no: 禁止用户手动缩放
        ============================================================
    -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <!-- 
        【iOS Safari 全屏模式设置】
        - apple-mobile-web-app-capable: 允许全屏运行
        - apple-mobile-web-app-status-bar-style: 状态栏样式
    -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- 【Android Chrome 主题色】 -->
    <meta name="theme-color" content="#ffffff">
    <title>薯片机 - AI 聊天 App</title>
    
    <style>
        /* 
            ================================================================
            【全局样式重置】
            - 清除所有默认边距和内边距
            - 使用 border-box 盒模型，方便计算尺寸
            - 设置默认字体为苹方/微软雅黑
            ================================================================
        */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Microsoft YaHei", "Helvetica Neue", sans-serif;
            /* 禁止文字选中，提升App体验 */
            -webkit-user-select: none;
            user-select: none;
            /* 禁止长按弹出菜单 */
            -webkit-touch-callout: none;
            /* 点击高亮透明 */
            -webkit-tap-highlight-color: transparent;
        }
        
        /* 
            【页面主体样式】
            - 纯白背景色
            - 黑色字体
            - 隐藏横向滚动条
        */
        html, body {
            width: 100%;
            height: 100%;
            background-color: #ffffff;
            color: #000000;
            overflow: hidden;
            font-size: 16px;
        }
        
        /* 
            ================================================================
            【全屏容器】
            - 占满整个视口
            - 使用 Flex 布局，垂直排列
            - 作为所有内容的根容器
            ================================================================
        */
        #app-container {
            width: 100%;
            height: 100vh;
            /* 使用 dvh 单位解决移动端地址栏问题 */
            height: 100dvh;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }

        /* 
            ================================================================
            【SVG图标通用样式】
            - 统一黑色线条风格
            - 不填充，只描边
            ================================================================
        */
        .icon-svg {
            width: 24px;
            height: 24px;
            stroke: #333;
            stroke-width: 1.5;
            fill: none;
            stroke-linecap: round;
            stroke-linejoin: round;
        }
        
        .icon-svg-sm {
            width: 20px;
            height: 20px;
        }
        
        .icon-svg-lg {
            width: 28px;
            height: 28px;
        }

        /* 
            ================================================================
            【顶部导航栏】
            - 固定在页面顶部
            - 高度56px（增加触摸区域）
            - 包含用户信息和添加按钮
            ================================================================
        */
        .top-nav {
            height: 56px;
            min-height: 56px;
            width: 100%;
            background-color: #ffffff;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            position: relative;
            z-index: 100;
            /* 适配顶部安全区域 */
            padding-top: env(safe-area-inset-top);
        }
        
        /* 
            【用户信息区域】
            - 左侧显示头像和用户名
            - 点击后打开侧边栏
        */
        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            padding: 8px;
            margin: -8px;
            border-radius: 12px;
            transition: background-color 0.2s ease;
        }
        .user-info:active {
            background-color: #f5f5f5;
        }
        
        /* 
            【用户头像】
            - 圆形头像
            - 默认显示"薯"字
        */
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 16px;
            color: #333;
            border: 2px solid #fff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        /* 【用户名称】 */
        .user-name {
            font-size: 17px;
            font-weight: 600;
            color: #000;
        }
        
        /* 
            【添加按钮】
            - 右上角的加号按钮
        */
        .add-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .add-btn:active {
            background-color: #f5f5f5;
            transform: scale(0.95);
        }

        /* 
            ================================================================
            【侧边功能栏】
            - 从左侧滑出的菜单
            - 宽度85%，最大320px
            ================================================================
        */
        .side-menu {
            position: fixed;
            top: 0;
            left: -100%;
            width: 85%;
            max-width: 320px;
            height: 100vh;
            height: 100dvh;
            background-color: #ffffff;
            z-index: 300;
            transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            box-shadow: 2px 0 20px rgba(0,0,0,0.1);
        }
        .side-menu.open {
            left: 0;
        }
        
        /* 
            【用户名片区域】
        */
        .card-info {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 50px 24px 30px;
            padding-top: calc(50px + env(safe-area-inset-top));
            background: linear-gradient(180deg, #fafafa 0%, #ffffff 100%);
            border-bottom: 1px solid #f0f0f0;
        }
        
        /* 【名片头像】 */
        .card-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: #f0f0f0;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: 600;
            color: #333;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        /* 【名片用户名】 */
        .card-name {
            font-size: 20px;
            font-weight: 600;
            color: #000;
            margin-bottom: 6px;
        }
        
        /* 【个性签名】 */
        .card-signature {
            font-size: 13px;
            color: #999;
            margin-bottom: 16px;
            text-align: center;
            padding: 0 20px;
        }
        
        /* 【编辑名片按钮】 */
        .card-edit {
            font-size: 13px;
            color: #666;
            cursor: pointer;
            padding: 8px 20px;
            background-color: #f5f5f5;
            border-radius: 20px;
            transition: background-color 0.2s;
        }
        .card-edit:active {
            background-color: #e8e8e8;
        }
        
        /* 
            【功能菜单列表】
        */
        .menu-list {
            flex: 1;
            padding: 12px 0;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        /* 【菜单项样式】 */
        .menu-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px 24px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        .menu-item:active {
            background-color: #f5f5f5;
        }
        
        /* 【菜单文字】 */
        .menu-text {
            font-size: 16px;
            color: #333;
        }
        
        /* 【菜单分隔线】 */
        .menu-divider {
            height: 8px;
            background-color: #f5f5f5;
            margin: 8px 0;
        }

        /* 
            ================================================================
            【遮罩层】
            ================================================================
        */
        .mask {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            height: 100dvh;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 250;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        .mask.show {
            opacity: 1;
            visibility: visible;
        }

        /* 
            ================================================================
            【主内容区域】
            ================================================================
        */
        .main-content {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            display: none;
            -webkit-overflow-scrolling: touch;
        }
        .main-content.active {
            display: block;
        }
        
        /* 
            ================================================================
            【消息页面】
            ================================================================
        */
        .msg-page {
            padding: 0;
        }
        
        /* 【搜索栏】 */
        .search-bar {
            padding: 12px 16px;
            background-color: #fff;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        .search-input-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
            background-color: #f5f5f5;
            border-radius: 22px;
            padding: 0 16px;
            height: 44px;
        }
        .search-input {
            flex: 1;
            height: 100%;
            background-color: transparent;
            border: none;
            font-size: 15px;
            color: #333;
            outline: none;
        }
        .search-input::placeholder {
            color: #999;
        }
        
        /* 【消息列表容器】 */
        .msg-list {
            padding: 0;
        }
        
        /* 【单条消息项】 */
        .msg-item {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 14px 16px;
            background-color: #fff;
            border-bottom: 1px solid #f5f5f5;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        .msg-item:active {
            background-color: #f8f8f8;
        }
        .msg-item.pinned {
            background-color: #fafafa;
        }
        
        /* 【消息头像】 */
        .msg-avatar {
            width: 54px;
            height: 54px;
            min-width: 54px;
            border-radius: 50%;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 500;
            color: #666;
            position: relative;
        }
        
        /* 【未读消息红点】 */
        .msg-badge {
            position: absolute;
            top: -4px;
            right: -4px;
            min-width: 20px;
            height: 20px;
            background-color: #ff4d4f;
            border-radius: 10px;
            font-size: 12px;
            font-weight: 500;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 6px;
            border: 2px solid #fff;
        }
        
        /* 【消息内容区域】 */
        .msg-content {
            flex: 1;
            min-width: 0;
        }
        
        /* 【消息标题行】 */
        .msg-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
        }
        
        /* 【联系人名称】 */
        .msg-title {
            font-size: 17px;
            font-weight: 500;
            color: #000;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* 【消息时间】 */
        .msg-time {
            font-size: 12px;
            color: #999;
            white-space: nowrap;
            margin-left: 10px;
        }
        
        /* 【最后一条消息预览】 */
        .msg-desc {
            font-size: 14px;
            color: #999;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* 
            ================================================================
            【好友页面】
            ================================================================
        */
        .friend-page {
            padding: 0;
        }
        
        /* 【好友分组】 */
        .friend-group {
            margin-bottom: 0;
        }
        
        /* 【分组标题栏】 */
        .group-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 16px;
            background-color: #fafafa;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
        }
        
        /* 【分组标题左侧】 */
        .group-title-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* 【展开/收起箭头】 */
        .group-arrow {
            width: 10px;
            height: 10px;
            border-right: 2px solid #666;
            border-bottom: 2px solid #666;
            transform: rotate(45deg);
            transition: transform 0.2s ease;
            margin-top: -3px;
        }
        .group-header.collapsed .group-arrow {
            transform: rotate(-45deg);
            margin-top: 3px;
        }
        
        /* 【分组名称】 */
        .group-title {
            font-size: 15px;
            font-weight: 500;
            color: #333;
        }
        
        /* 【分组人数】 */
        .group-count {
            font-size: 13px;
            color: #999;
        }
        
        /* 【分组编辑按钮】 */
        .group-edit {
            font-size: 13px;
            color: #666;
            padding: 6px 12px;
        }
        
        /* 【好友列表】 */
        .friend-list {
            display: none;
            flex-direction: column;
        }
        .friend-list.show {
            display: flex;
        }
        
        /* 【单个好友项】 */
        .friend-item {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 12px 16px 12px 40px;
            background-color: #fff;
            border-bottom: 1px solid #f5f5f5;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        .friend-item:active {
            background-color: #f8f8f8;
        }
        
        /* 【好友头像】 */
        .friend-avatar {
            width: 48px;
            height: 48px;
            min-width: 48px;
            border-radius: 50%;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: 500;
            color: #666;
        }
        
        /* 【好友信息】 */
        .friend-info {
            flex: 1;
            min-width: 0;
        }
        
        /* 【好友名称】 */
        .friend-name {
            font-size: 16px;
            font-weight: 500;
            color: #000;
            margin-bottom: 4px;
        }
        
        /* 【好友签名/状态】 */
        .friend-status {
            font-size: 13px;
            color: #999;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* 
            ================================================================
            【动态页面】
            ================================================================
        */
        .dynamic-page {
            padding: 0;
            background-color: #f5f5f5;
        }
        
        /* 【功能列表】 */
        .func-list {
            padding: 12px 0;
        }
        
        /* 【功能项】 */
        .func-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px;
            background-color: #fff;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        .func-item:active {
            background-color: #f8f8f8;
        }
        .func-item:not(:last-child) {
            border-bottom: 1px solid #f5f5f5;
        }
        
        /* 【功能项左侧】 */
        .func-left {
            display: flex;
            align-items: center;
            gap: 14px;
        }
        
        /* 【功能图标容器】 */
        .func-icon {
            width: 46px;
            height: 46px;
            border-radius: 12px;
            background-color: #f5f5f5;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* 【功能名称和描述】 */
        .func-info {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        .func-name {
            font-size: 16px;
            font-weight: 500;
            color: #000;
        }
        .func-desc {
            font-size: 13px;
            color: #999;
        }
        
        /* 【功能项右侧箭头】 */
        .func-arrow {
            width: 8px;
            height: 8px;
            border-top: 2px solid #ccc;
            border-right: 2px solid #ccc;
            transform: rotate(45deg);
        }
        
        /* 【功能分隔区域】 */
        .func-divider {
            height: 12px;
            background-color: #f5f5f5;
        }
        
        /* 【功能分组标题】 */
        .func-section-title {
            padding: 20px 16px 10px;
            font-size: 13px;
            color: #999;
            background-color: #f5f5f5;
        }

        /* 
            ================================================================
            【功能子页面容器】
            ================================================================
        */
        .sub-page {
            position: fixed;
            top: 0;
            left: 100%;
            width: 100%;
            height: 100vh;
            height: 100dvh;
            background-color: #fff;
            z-index: 200;
            transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
        }
        .sub-page.open {
            left: 0;
        }
        
        /* 【子页面顶部导航】 */
        .sub-nav {
            height: 56px;
            min-height: 56px;
            display: flex;
            align-items: center;
            padding: 0 16px;
            padding-top: env(safe-area-inset-top);
            background-color: #fff;
            border-bottom: 1px solid #f0f0f0;
            position: relative;
        }
        
        /* 【返回按钮】 */
        .back-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 10px;
            margin: -10px;
            cursor: pointer;
            font-size: 16px;
            color: #333;
        }
        .back-arrow {
            width: 10px;
            height: 10px;
            border-left: 2px solid #333;
            border-bottom: 2px solid #333;
            transform: rotate(45deg);
        }
        
        /* 【子页面标题】 */
        .sub-title {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            font-size: 17px;
            font-weight: 600;
            color: #000;
        }
        
        /* 【子页面内容区域】 */
        .sub-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px 16px;
            -webkit-overflow-scrolling: touch;
        }
        
        /* 【占位提示文字】 */
        .placeholder-text {
            text-align: center;
            color: #999;
            padding: 60px 20px;
            font-size: 15px;
            line-height: 2;
        }

        /* 
            ================================================================
            【底部标签栏】
            ================================================================
        */
        .tab-bar {
            height: 60px;
            min-height: 60px;
            width: 100%;
            background-color: #ffffff;
            border-top: 1px solid #f0f0f0;
            display: flex;
            justify-content: space-around;
            align-items: center;
            /* 适配iPhone底部安全区域 */
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        /* 【标签项】 */
        .tab-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 4px;
            cursor: pointer;
            padding: 8px 24px;
            position: relative;
        }
        .tab-item .icon-svg {
            stroke: #999;
            transition: stroke 0.2s;
        }
        .tab-item.active .icon-svg {
            stroke: #000;
            stroke-width: 2;
        }
        
        /* 【标签文字】 */
        .tab-text {
            font-size: 11px;
            color: #999;
            transition: color 0.2s;
        }
        .tab-item.active .tab-text {
            color: #000;
            font-weight: 500;
        }

        /* 
            ================================================================
            【添加弹窗】
            ================================================================
        */
        .add-popup {
            position: fixed;
            top: 60px;
            right: 12px;
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            z-index: 150;
            opacity: 0;
            visibility: hidden;
            transform: scale(0.9) translateY(-10px);
            transform-origin: top right;
            transition: all 0.2s ease;
            overflow: hidden;
        }
        .add-popup.show {
            opacity: 1;
            visibility: visible;
            transform: scale(1) translateY(0);
        }
        
        /* 【弹窗选项】 */
        .popup-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            cursor: pointer;
            white-space: nowrap;
            transition: background-color 0.2s ease;
        }
        .popup-item:active {
            background-color: #f5f5f5;
        }
        .popup-item:not(:last-child) {
            border-bottom: 1px solid #f5f5f5;
        }
        
        /* 【弹窗文字】 */
        .popup-text {
            font-size: 15px;
            color: #333;
        }

        /* 
            ================================================================
            【聊天页面】
            ================================================================
        */
        .chat-page {
            position: fixed;
            top: 0;
            left: 100%;
            width: 100%;
            height: 100vh;
            height: 100dvh;
            background-color: #f5f5f5;
            z-index: 200;
            transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
        }
        .chat-page.open {
            left: 0;
        }
        
        /* 【聊天顶部导航】 */
        .chat-nav {
            height: 56px;
            min-height: 56px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            padding-top: env(safe-area-inset-top);
            background-color: #fff;
            border-bottom: 1px solid #f0f0f0;
        }
        
        /* 【聊天对象名称】 */
        .chat-title {
            font-size: 17px;
            font-weight: 600;
            color: #000;
        }
        
        /* 【聊天更多按钮】 */
        .chat-more {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        
        /* 【聊天消息区域】 */
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            display: flex;
            flex-direction: column;
            gap: 16px;
            -webkit-overflow-scrolling: touch;
        }
        
        /* 【消息气泡】 */
        .chat-bubble {
            display: flex;
            gap: 12px;
            max-width: 85%;
        }
        .chat-bubble.received {
            align-self: flex-start;
        }
        .chat-bubble.sent {
            align-self: flex-end;
            flex-direction: row-reverse;
        }
        
        /* 【聊天头像】 */
        .chat-avatar {
            width: 40px;
            height: 40px;
            min-width: 40px;
            border-radius: 50%;
            background-color: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: 500;
            color: #666;
        }
        
        /* 【消息内容】 */
        .chat-text {
            padding: 12px 16px;
            border-radius: 20px;
            font-size: 16px;
            line-height: 1.5;
            word-break: break-word;
        }
        .chat-bubble.received .chat-text {
            background-color: #fff;
            color: #333;
            border-top-left-radius: 6px;
        }
        .chat-bubble.sent .chat-text {
            background-color: #000;
            color: #fff;
            border-top-right-radius: 6px;
        }
        
        /* 【聊天输入区域】 */
        .chat-input-area {
            display: flex;
            align-items: flex-end;
            gap: 12px;
            padding: 12px 16px;
            background-color: #fff;
好的，继续输出剩余代码：

```html
            border-top: 1px solid #f0f0f0;
            padding-bottom: calc(12px + env(safe-area-inset-bottom));
        }
        
        /* 【输入框】 */
        .chat-input {
            flex: 1;
            min-height: 40px;
            max-height: 120px;
            padding: 10px 16px;
            border: 1px solid #e0e0e0;
            border-radius: 20px;
            font-size: 16px;
            resize: none;
            outline: none;
            line-height: 1.4;
            background-color: #f5f5f5;
        }
        .chat-input:focus {
            border-color: #333;
            background-color: #fff;
        }
        
        /* 【发送按钮】 */
        .chat-send-btn {
            width: 40px;
            height: 40px;
            min-width: 40px;
            background-color: #000;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s ease;
        }
        .chat-send-btn:active {
            transform: scale(0.95);
        }
        .chat-send-btn .icon-svg {
            stroke: #fff;
            width: 20px;
            height: 20px;
        }

        /* 
            ================================================================
            【名片编辑页面】
            ================================================================
        */
        .card-edit-page {
            position: fixed;
            top: 0;
            left: 100%;
            width: 100%;
            height: 100vh;
            height: 100dvh;
            background-color: #f5f5f5;
            z-index: 200;
            transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
        }
        .card-edit-page.open {
            left: 0;
        }
        
        /* 【编辑项】 */
        .edit-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px;
            background-color: #fff;
            border-bottom: 1px solid #f5f5f5;
            cursor: pointer;
        }
        .edit-item:active {
            background-color: #f8f8f8;
        }
        
        /* 【编辑项标签】 */
        .edit-label {
            font-size: 16px;
            color: #333;
        }
        
        /* 【编辑项内容】 */
        .edit-value {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #999;
            font-size: 15px;
            max-width: 60%;
        }
        .edit-value span {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* 【编辑项箭头】 */
        .edit-arrow {
            width: 8px;
            height: 8px;
            border-top: 2px solid #ccc;
            border-right: 2px solid #ccc;
            transform: rotate(45deg);
            flex-shrink: 0;
        }
        
        /* 【编辑头像预览】 */
        .edit-avatar {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            color: #666;
        }

        /* 
            ================================================================
            【通用工具类】
            ================================================================
        */
        .hidden {
            display: none !important;
        }
        
        /* 【加载动画】 */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 30px;
        }
        .loading-spinner {
            width: 28px;
            height: 28px;
            border: 2px solid #f0f0f0;
            border-top-color: #333;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* 【空状态提示】 */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 60px 20px;
            color: #999;
        }
        .empty-icon {
            width: 80px;
            height: 80px;
            background-color: #f5f5f5;
            border-radius: 50%;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .empty-text {
            font-size: 15px;
        }

        /* 
            ================================================================
            【API设置页面样式】
            ================================================================
        */
        .settings-section {
            margin-bottom: 20px;
        }
        .settings-section-title {
            padding: 12px 16px;
            font-size: 13px;
            color: #999;
            background-color: #f5f5f5;
        }
        .settings-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px;
            background-color: #fff;
            border-bottom: 1px solid #f5f5f5;
        }
        .settings-item-left {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        .settings-item-title {
            font-size: 16px;
            color: #333;
        }
        .settings-item-desc {
            font-size: 13px;
            color: #999;
        }
        .settings-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            font-size: 15px;
            outline: none;
            margin-top: 8px;
        }
        .settings-input:focus {
            border-color: #333;
        }
        .settings-select {
            padding: 8px 12px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            outline: none;
            background-color: #fff;
        }
    </style>
</head>
<body>
    <!-- 
        ================================================================
        【SVG图标定义】
        - 所有图标统一在这里定义
        - 使用symbol和use方式复用
        ================================================================
    -->
    <svg style="display: none;">
        <!-- 添加/加号图标 -->
        <symbol id="icon-add" viewBox="0 0 24 24">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
        </symbol>
        
        <!-- 消息图标 -->
        <symbol id="icon-message" viewBox="0 0 24 24">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
        </symbol>
        
        <!-- 好友/用户图标 -->
        <symbol id="icon-friends" viewBox="0 0 24 24">
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
            <circle cx="9" cy="7" r="4"></circle>
            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
        </symbol>
        
        <!-- 动态/发现图标 -->
        <symbol id="icon-discover" viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="10"></circle>
            <polygon points="16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"></polygon>
        </symbol>
        
        <!-- 搜索图标 -->
        <symbol id="icon-search" viewBox="0 0 24 24">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </symbol>
        
        <!-- 钱包图标 -->
        <symbol id="icon-wallet" viewBox="0 0 24 24">
            <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
            <line x1="1" y1="10" x2="23" y2="10"></line>
        </symbol>
        
        <!-- 收藏/星星图标 -->
        <symbol id="icon-star" viewBox="0 0 24 24">
            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
        </symbol>
        
        <!-- 表情包图标 -->
        <symbol id="icon-emoji" viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M8 14s1.5 2 4 2 4-2 4-2"></path>
            <line x1="9" y1="9" x2="9.01" y2="9"></line>
            <line x1="15" y1="9" x2="15.01" y2="9"></line>
        </symbol>
        
        <!-- 世界书/书本图标 -->
        <symbol id="icon-book" viewBox="0 0 24 24">
            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
        </symbol>
        
        <!-- 装扮/画笔图标 -->
        <symbol id="icon-brush" viewBox="0 0 24 24">
            <path d="M12 19l7-7 3 3-7 7-3-3z"></path>
            <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"></path>
            <path d="M2 2l7.586 7.586"></path>
            <circle cx="11" cy="11" r="2"></circle>
        </symbol>
        
        <!-- API/代码图标 -->
        <symbol id="icon-code" viewBox="0 0 24 24">
            <polyline points="16 18 22 12 16 6"></polyline>
            <polyline points="8 6 2 12 8 18"></polyline>
        </symbol>
        
        <!-- 聊天总结/文档图标 -->
        <symbol id="icon-file-text" viewBox="0 0 24 24">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
            <line x1="16" y1="13" x2="8" y2="13"></line>
            <line x1="16" y1="17" x2="8" y2="17"></line>
            <polyline points="10 9 9 9 8 9"></polyline>
        </symbol>
        
        <!-- 设置图标 -->
        <symbol id="icon-settings" viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="3"></circle>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
        </symbol>
        
        <!-- 朋友圈图标 -->
        <symbol id="icon-image" viewBox="0 0 24 24">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
            <circle cx="8.5" cy="8.5" r="1.5"></circle>
            <polyline points="21 15 16 10 5 21"></polyline>
        </symbol>
        
        <!-- 论坛图标 -->
        <symbol id="icon-users" viewBox="0 0 24 24">
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
            <circle cx="9" cy="7" r="4"></circle>
            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
        </symbol>
        
        <!-- 小红书/心形图标 -->
        <symbol id="icon-heart" viewBox="0 0 24 24">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
        </symbol>
        
        <!-- 游戏图标 -->
        <symbol id="icon-gamepad" viewBox="0 0 24 24">
            <line x1="6" y1="12" x2="10" y2="12"></line>
            <line x1="8" y1="10" x2="8" y2="14"></line>
            <line x1="15" y1="13" x2="15.01" y2="13"></line>
            <line x1="18" y1="11" x2="18.01" y2="11"></line>
            <rect x="2" y="6" width="20" height="12" rx="2"></rect>
        </symbol>
        
        <!-- 阅读图标 -->
        <symbol id="icon-book-open" viewBox="0 0 24 24">
            <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
            <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
        </symbol>
        
        <!-- SillyTavern/魔法棒图标 -->
        <symbol id="icon-wand" viewBox="0 0 24 24">
            <path d="M15 4V2"></path>
            <path d="M15 16v-2"></path>
            <path d="M8 9h2"></path>
            <path d="M20 9h2"></path>
            <path d="M17.8 11.8L19 13"></path>
            <path d="M15 9h0"></path>
            <path d="M17.8 6.2L19 5"></path>
            <path d="M3 21l9-9"></path>
            <path d="M12.2 6.2L11 5"></path>
        </symbol>
        
        <!-- 日历图标 -->
        <symbol id="icon-calendar" viewBox="0 0 24 24">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="16" y1="2" x2="16" y2="6"></line>
            <line x1="8" y1="2" x2="8" y2="6"></line>
            <line x1="3" y1="10" x2="21" y2="10"></line>
        </symbol>
        
        <!-- 一起听/音乐图标 -->
        <symbol id="icon-music" viewBox="0 0 24 24">
            <path d="M9 18V5l12-2v13"></path>
            <circle cx="6" cy="18" r="3"></circle>
            <circle cx="18" cy="16" r="3"></circle>
        </symbol>
        
        <!-- 添加好友图标 -->
        <symbol id="icon-user-plus" viewBox="0 0 24 24">
            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
            <circle cx="8.5" cy="7" r="4"></circle>
            <line x1="20" y1="8" x2="20" y2="14"></line>
            <line x1="23" y1="11" x2="17" y2="11"></line>
        </symbol>
        
        <!-- 创建群聊图标 -->
        <symbol id="icon-users-plus" viewBox="0 0 24 24">
            <path d="M14 19a6 6 0 0 0-12 0"></path>
            <circle cx="8" cy="9" r="4"></circle>
            <line x1="19" y1="8" x2="19" y2="14"></line>
            <line x1="22" y1="11" x2="16" y2="11"></line>
        </symbol>
        
        <!-- 扫一扫图标 -->
        <symbol id="icon-scan" viewBox="0 0 24 24">
            <path d="M3 7V5a2 2 0 0 1 2-2h2"></path>
            <path d="M17 3h2a2 2 0 0 1 2 2v2"></path>
            <path d="M21 17v2a2 2 0 0 1-2 2h-2"></path>
            <path d="M7 21H5a2 2 0 0 1-2-2v-2"></path>
            <line x1="3" y1="12" x2="21" y2="12"></line>
        </symbol>
        
        <!-- 更多/三点图标 -->
        <symbol id="icon-more" viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="1"></circle>
            <circle cx="19" cy="12" r="1"></circle>
            <circle cx="5" cy="12" r="1"></circle>
        </symbol>
        
        <!-- 发送图标 -->
        <symbol id="icon-send" viewBox="0 0 24 24">
            <line x1="22" y1="2" x2="11" y2="13"></line>
            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
        </symbol>
        
        <!-- 返回箭头图标 -->
        <symbol id="icon-arrow-left" viewBox="0 0 24 24">
            <line x1="19" y1="12" x2="5" y2="12"></line>
            <polyline points="12 19 5 12 12 5"></polyline>
        </symbol>
    </svg>

    <!-- 
        ================================================================
        【应用主容器】
        ================================================================
    -->
    <div id="app-container">
        
        <!-- 
            ============================================================
            【顶部导航栏】
            ============================================================
        -->
        <div class="top-nav" id="top-nav">
            <div class="user-info" id="user-info">
                <div class="user-avatar">薯</div>
                <div class="user-name">薯片机用户</div>
            </div>
            <div class="add-btn" id="add-btn">
                <svg class="icon-svg"><use href="#icon-add"></use></svg>
            </div>
        </div>

        <!-- 
            ============================================================
            【添加弹窗】
            ============================================================
        -->
        <div class="add-popup" id="add-popup">
            <div class="popup-item" id="add-friend-btn">
                <svg class="icon-svg icon-svg-sm"><use href="#icon-user-plus"></use></svg>
                <div class="popup-text">添加AI好友</div>
            </div>
            <div class="popup-item" id="create-group-btn">
                <svg class="icon-svg icon-svg-sm"><use href="#icon-users-plus"></use></svg>
                <div class="popup-text">创建AI群聊</div>
            </div>
            <div class="popup-item" id="scan-btn">
                <svg class="icon-svg icon-svg-sm"><use href="#icon-scan"></use></svg>
                <div class="popup-text">扫一扫</div>
            </div>
        </div>

        <!-- 
            ============================================================
            【侧边功能栏】
            ============================================================
        -->
        <div class="side-menu" id="side-menu">
            <div class="card-info">
                <div class="card-avatar">薯</div>
                <div class="card-name" id="display-name">薯片机用户</div>
                <div class="card-signature">这个人很懒，什么都没写~</div>
                <div class="card-edit" id="card-edit-btn">编辑个性名片</div>
            </div>
            
            <div class="menu-list">
                <div class="menu-item" data-func="wallet">
                    <svg class="icon-svg"><use href="#icon-wallet"></use></svg>
                    <div class="menu-text">钱包</div>
                </div>
                
                <div class="menu-item" data-func="collection">
                    <svg class="icon-svg"><use href="#icon-star"></use></svg>
                    <div class="menu-text">收藏</div>
                </div>
                
                <div class="menu-item" data-func="emoji">
                    <svg class="icon-svg"><use href="#icon-emoji"></use></svg>
                    <div class="menu-text">表情包</div>
                </div>
                
                <!-- 新增：世界书 -->
                <div class="menu-item" data-func="worldbook">
                    <svg class="icon-svg"><use href="#icon-book"></use></svg>
                    <div class="menu-text">世界书</div>
                </div>
                
                <div class="menu-divider"></div>
                
                <div class="menu-item" data-func="decoration">
                    <svg class="icon-svg"><use href="#icon-brush"></use></svg>
                    <div class="menu-text">个性装扮</div>
                </div>
                
                <div class="menu-item" data-func="api-settings">
                    <svg class="icon-svg"><use href="#icon-code"></use></svg>
                    <div class="menu-text">API设置</div>
                </div>
                
                <!-- 新增：聊天总结 -->
                <div class="menu-item" data-func="chat-summary">
                    <svg class="icon-svg"><use href="#icon-file-text"></use></svg>
                    <div class="menu-text">聊天总结</div>
                </div>
                
                <div class="menu-divider"></div>
                
                <div class="menu-item" data-func="settings">
                    <svg class="icon-svg"><use href="#icon-settings"></use></svg>
                    <div class="menu-text">设置</div>
                </div>
            </div>
        </div>

        <!-- 【遮罩层】 -->
        <div class="mask" id="mask"></div>

        <!-- 
            ============================================================
            【主内容区域 - 消息页面】
            ============================================================
        -->
        <div class="main-content msg-page active" id="msg-page">
            <div class="search-bar">
                <div class="search-input-wrapper">
                    <svg class="icon-svg icon-svg-sm" style="stroke: #999;"><use href="#icon-search"></use></svg>
                    <input type="text" class="search-input" placeholder="搜索" id="search-input">
                </div>
            </div>
            
            <div class="msg-list" id="msg-list">
                <div class="msg-item" data-chat-id="1" data-chat-name="AI小助手">
                    <div class="msg-avatar">助</div>
                    <div class="msg-content">
                        <div class="msg-header">
                            <div class="msg-title">AI小助手</div>
                            <div class="msg-time">12:30</div>
                        </div>
                        <div class="msg-desc">你好呀，有什么可以帮你的吗？</div>
                    </div>
                </div>
                
                <div class="msg-item" data-chat-id="2" data-chat-name="古风美人">
                    <div class="msg-avatar">古</div>
                    <div class="msg-content">
                        <div class="msg-header">
                            <div class="msg-title">古风美人</div>
                            <div class="msg-time">昨天</div>
                        </div>
                        <div class="msg-desc">公子，今日月色真美~</div>
                    </div>
                </div>
                
                <div class="msg-item" data-chat-id="3" data-chat-name="二次元女友">
                    <div class="msg-avatar">
                        二
                        <div class="msg-badge">3</div>
                    </div>
                    <div class="msg-content">
                        <div class="msg-header">
                            <div class="msg-title">二次元女友</div>
                            <div class="msg-time">前天</div>
                        </div>
                        <div class="msg-desc">[图片]</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 
            ============================================================
            【主内容区域 - 好友页面】
            ============================================================
        -->
        <div class="main-content friend-page" id="friend-page">
            <div class="friend-group">
                <div class="group-header" data-group="common">
                    <div class="group-title-left">
                        <div class="group-arrow"></div>
                        <div class="group-title">常用AI</div>
                        <div class="group-count">(3/3)</div>
                    </div>
                    <div class="group-edit">管理</div>
                </div>
                <div class="friend-list show" data-group="common">
                    <div class="friend-item" data-friend-id="1">
                        <div class="friend-avatar">助</div>
                        <div class="friend-info">
                            <div class="friend-name">AI小助手</div>
                            <div class="friend-status 好的，继续输出剩余代码：

```html
">智能助手，随时为您服务</div>
                        </div>
                    </div>
                    <div class="friend-item" data-friend-id="2">
                        <div class="friend-avatar">古</div>
                        <div class="friend-info">
                            <div class="friend-name">古风美人</div>
                            <div class="friend-status">温婉如玉，静待君归</div>
                        </div>
                    </div>
                    <div class="friend-item" data-friend-id="3">
                        <div class="friend-avatar">二</div>
                        <div class="friend-info">
                            <div class="friend-name">二次元女友</div>
                            <div class="friend-status">欧尼酱，今天也要元气满满哦~</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="friend-group">
                <div class="group-header collapsed" data-group="roleplay">
                    <div class="group-title-left">
                        <div class="group-arrow"></div>
                        <div class="group-title">角色扮演</div>
                        <div class="group-count">(0/5)</div>
                    </div>
                    <div class="group-edit">管理</div>
                </div>
                <div class="friend-list" data-group="roleplay">
                    <!-- 角色扮演分组的好友 -->
                </div>
            </div>
            
            <div class="friend-group">
                <div class="group-header collapsed" data-group="assistant">
                    <div class="group-title-left">
                        <div class="group-arrow"></div>
                        <div class="group-title">工作助手</div>
                        <div class="group-count">(0/3)</div>
                    </div>
                    <div class="group-edit">管理</div>
                </div>
                <div class="friend-list" data-group="assistant">
                    <!-- 工作助手分组的好友 -->
                </div>
            </div>
        </div>

        <!-- 
            ============================================================
            【主内容区域 - 动态页面】
            ============================================================
        -->
        <div class="main-content dynamic-page" id="dynamic-page">
            <div class="func-list">
                <!-- 社交功能区 -->
                <div class="func-section-title">社交娱乐</div>
                
                <div class="func-item" data-page="moments-page">
                    <div class="func-left">
                        <div class="func-icon">
                            <svg class="icon-svg"><use href="#icon-image"></use></svg>
                        </div>
                        <div class="func-info">
                            <div class="func-name">朋友圈</div>
                            <div class="func-desc">查看AI好友的动态</div>
                        </div>
                    </div>
                    <div class="func-arrow"></div>
                </div>
                
                <div class="func-item" data-page="forum-page">
                    <div class="func-left">
                        <div class="func-icon">
                            <svg class="icon-svg"><use href="#icon-users"></use></svg>
                        </div>
                        <div class="func-info">
                            <div class="func-name">论坛</div>
                            <div class="func-desc">角色卡分享与讨论</div>
                        </div>
                    </div>
                    <div class="func-arrow"></div>
                </div>
                
                <div class="func-item" data-page="redbook-page">
                    <div class="func-left">
                        <div class="func-icon">
                            <svg class="icon-svg"><use href="#icon-heart"></use></svg>
                        </div>
                        <div class="func-info">
                            <div class="func-name">小红书</div>
                            <div class="func-desc">发现精彩内容</div>
                        </div>
                    </div>
                    <div class="func-arrow"></div>
                </div>
                
                <!-- 新增：日历 -->
                <div class="func-item" data-page="calendar-page">
                    <div class="func-left">
                        <div class="func-icon">
                            <svg class="icon-svg"><use href="#icon-calendar"></use></svg>
                        </div>
                        <div class="func-info">
                            <div class="func-name">日历</div>
                            <div class="func-desc">管理日程与提醒</div>
                        </div>
                    </div>
                    <div class="func-arrow"></div>
                </div>
                
                <!-- 新增：一起听 -->
                <div class="func-item" data-page="music-page">
                    <div class="func-left">
                        <div class="func-icon">
                            <svg class="icon-svg"><use href="#icon-music"></use></svg>
                        </div>
                        <div class="func-info">
                            <div class="func-name">一起听</div>
                            <div class="func-desc">与AI一起听音乐</div>
                        </div>
                    </div>
                    <div class="func-arrow"></div>
                </div>
                
                <div class="func-divider"></div>
                
                <!-- 工具功能区 -->
                <div class="func-section-title">AI工具</div>
                
                <div class="func-item" data-page="game-page">
                    <div class="func-left">
                        <div class="func-icon">
                            <svg class="icon-svg"><use href="#icon-gamepad"></use></svg>
                        </div>
                        <div class="func-info">
                            <div class="func-name">小游戏</div>
                            <div class="func-desc">与AI互动小游戏</div>
                        </div>
                    </div>
                    <div class="func-arrow"></div>
                </div>
                
                <div class="func-item" data-page="reading-page">
                    <div class="func-left">
                        <div class="func-icon">
                            <svg class="icon-svg"><use href="#icon-book-open"></use></svg>
                        </div>
                        <div class="func-info">
                            <div class="func-name">阅读</div>
                            <div class="func-desc">AI陪你读书</div>
                        </div>
                    </div>
                    <div class="func-arrow"></div>
                </div>
                
                <div class="func-item" data-page="sillytavern-page">
                    <div class="func-left">
                        <div class="func-icon">
                            <svg class="icon-svg"><use href="#icon-wand"></use></svg>
                        </div>
                        <div class="func-info">
                            <div class="func-name">SillyTavern简约版</div>
                            <div class="func-desc">高级角色扮演工具</div>
                        </div>
                    </div>
                    <div class="func-arrow"></div>
                </div>
            </div>
        </div>

        <!-- 
            ============================================================
            【底部标签栏】
            ============================================================
        -->
        <div class="tab-bar" id="tab-bar">
            <div class="tab-item active" data-tab="msg-page">
                <svg class="icon-svg"><use href="#icon-message"></use></svg>
                <div class="tab-text">消息</div>
            </div>
            <div class="tab-item" data-tab="friend-page">
                <svg class="icon-svg"><use href="#icon-friends"></use></svg>
                <div class="tab-text">好友</div>
            </div>
            <div class="tab-item" data-tab="dynamic-page">
                <svg class="icon-svg"><use href="#icon-discover"></use></svg>
                <div class="tab-text">动态</div>
            </div>
        </div>

        <!-- 
            ============================================================
            【子页面 - 朋友圈】
            ============================================================
        -->
        <div class="sub-page" id="moments-page">
            <div class="sub-nav">
                <div class="back-btn" data-back="moments-page">
                    <svg class="icon-svg icon-svg-sm"><use href="#icon-arrow-left"></use></svg>
                </div>
                <div class="sub-title">朋友圈</div>
            </div>
            <div class="sub-content">
                <div class="placeholder-text">
                    【朋友圈功能开发中】<br><br>
                    计划功能：<br>
                    • AI好友自动发布动态<br>
                    • 点赞、评论互动<br>
                    • 图片/视频分享
                </div>
            </div>
        </div>

        <!-- 【子页面 - 论坛】 -->
        <div class="sub-page" id="forum-page">
            <div class="sub-nav">
                <div class="back-btn" data-back="forum-page">
                    <svg class="icon-svg icon-svg-sm"><use href="#icon-arrow-left"></use></svg>
                </div>
                <div class="sub-title">论坛</div>
            </div>
            <div class="sub-content">
                <div class="placeholder-text">
                    【论坛功能开发中】<br><br>
                    计划功能：<br>
                    • 角色卡分享与下载<br>
                    • 使用心得交流<br>
                    • 创作教程
                </div>
            </div>
        </div>

        <!-- 【子页面 - 小红书】 -->
        <div class="sub-page" id="redbook-page">
            <div class="sub-nav">
                <div class="back-btn" data-back="redbook-page">
                    <svg class="icon-svg icon-svg-sm"><use href="#icon-arrow-left"></use></svg>
                </div>
                <div class="sub-title">小红书</div>
            </div>
            <div class="sub-content">
                <div class="placeholder-text">
                    【小红书功能开发中】<br><br>
                    计划功能：<br>
                    • 精选内容推荐<br>
                    • 图文笔记浏览<br>
                    • 收藏与分享
                </div>
            </div>
        </div>

        <!-- 【子页面 - 日历】新增 -->
        <div class="sub-page" id="calendar-page">
            <div class="sub-nav">
                <div class="back-btn" data-back="calendar-page">
                    <svg class="icon-svg icon-svg-sm"><use href="#icon-arrow-left"></use></svg>
                </div>
                <div class="sub-title">日历</div>
            </div>
            <div class="sub-content">
                <div class="placeholder-text">
                    【日历功能开发中】<br><br>
                    计划功能：<br>
                    • 日程管理<br>
                    • AI提醒助手<br>
                    • 纪念日记录<br>
                    • 与AI角色的约会安排
                </div>
            </div>
        </div>

        <!-- 【子页面 - 一起听】新增 -->
        <div class="sub-page" id="music-page">
            <div class="sub-nav">
                <div class="back-btn" data-back="music-page">
                    <svg class="icon-svg icon-svg-sm"><use href="#icon-arrow-left"></use></svg>
                </div>
                <div class="sub-title">一起听</div>
            </div>
            <div class="sub-content">
                <div class="placeholder-text">
                    【一起听功能开发中】<br><br>
                    计划功能：<br>
                    • 与AI一起听音乐<br>
                    • 音乐推荐<br>
                    • 歌词分享<br>
                    • 音乐心情交流
                </div>
            </div>
        </div>

        <!-- 【子页面 - 小游戏】 -->
        <div class="sub-page" id="game-page">
            <div class="sub-nav">
                <div class="back-btn" data-back="game-page">
                    <svg class="icon-svg icon-svg-sm"><use href="#icon-arrow-left"></use></svg>
                </div>
                <div class="sub-title">小游戏</div>
            </div>
            <div class="sub-content">
                <div class="placeholder-text">
                    【小游戏功能开发中】<br><br>
                    计划功能：<br>
                    • 文字冒险游戏<br>
                    • 猜谜互动<br>
                    • 角色扮演剧本
                </div>
            </div>
        </div>

        <!-- 【子页面 - 阅读】 -->
        <div class="sub-page" id="reading-page">
            <div class="sub-nav">
                <div class="back-btn" data-back="reading-page">
                    <svg class="icon-svg icon-svg-sm"><use href="#icon-arrow-left"></use></svg>
                </div>
                <div class="sub-title">阅读</div>
            </div>
            <div class="sub-content">
                <div class="placeholder-text">
                    【阅读功能开发中】<br><br>
                    计划功能：<br>
                    • AI朗读小说<br>
                    • 阅读笔记<br>
                    • 书籍推荐
                </div>
            </div>
        </div>

        <!-- 【子页面 - SillyTavern简约版】 -->
        <div class="sub-page" id="sillytavern-page">
            <div class="sub-nav">
                <div class="back-btn" data-back="sillytavern-page">
                    <svg class="icon-svg icon-svg-sm"><use href="#icon-arrow-left"></use></svg>
                </div>
                <div class="sub-title">SillyTavern简约版</div>
            </div>
            <div class="sub-content">
                <div class="placeholder-text">
                    【SillyTavern简约版开发中】<br><br>
                    计划功能：<br>
                    • 角色卡导入（PNG/JSON）<br>
                    • 世界书/知识库<br>
                    • 预设管理（Prompt模板）<br>
                    • 高级对话参数设置<br>
                    • 多角色群聊
                </div>
            </div>
        </div>

        <!-- 【子页面 - API设置】 -->
        <div class="sub-page" id="api-settings-page">
            <div class="sub-nav">
                <div class="back-btn" data-back="api-settings-page">
                    <svg class="icon-svg icon-svg-sm"><use href="#icon-arrow-left"></use></svg>
                </div>
                <div class="sub-title">API设置</div>
            </div>
            <div class="sub-content" style="padding: 0; background-color: #f5f5f5;">
                <div class="settings-section">
                    <div class="settings-section-title">基础配置</div>
                    <div class="settings-item" style="flex-direction: column; align-items: stretch;">
                        <div class="settings-item-left">
                            <div class="settings-item-title">API密钥</div>
                            <div class="settings-item-desc">输入您的API Key</div>
                        </div>
                        <input type="password" class="settings-input" placeholder="sk-xxxxxxxx" id="api-key-input">
                    </div>
                    <div class="settings-item" style="flex-direction: column; align-items: stretch;">
                        <div class="settings-item-left">
                            <div class="settings-item-title">API地址</div>
                            <div class="settings-item-desc">自定义API端点</div>
                        </div>
                        <input type="text" class="settings-input" placeholder="https://api.openai.com/v1" id="api-url-input">
                    </div>
                    <div class="settings-item">
                        <div class="settings-item-left">
                            <div class="settings-item-title">模型选择</div>
                        </div>
                        <select class="settings-select" id="model-select">
                            <option value="gpt-3.5-turbo">GPT-3.5</option>
                            <option value="gpt-4">GPT-4</option>
                            <option value="gpt-4-turbo">GPT-4 Turbo</option>
                            <option value="claude-3-opus">Claude 3 Opus</option>
                            <option value="claude-3-sonnet">Claude 3 Sonnet</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <!-- 【子页面 - 世界书】新增 -->
        <div class="sub-page" id="worldbook-page">
            <div class="sub-nav">
                <div class="back-btn" data-back="worldbook-page">
                    <svg class="icon-svg icon-svg-sm"><use href="#icon-arrow-left"></use></svg>
                </div>
                <div class="sub-title">世界书</div>
            </div>
            <div class="sub-content">
                <div class="placeholder-text">
                    【世界书功能开发中】<br><br>
                    计划功能：<br>
                    • 创建/导入世界观设定<br>
                    • 关键词触发条目<br>
                    • 角色知识库管理<br>
                    • 多世界书切换
                </div>
            </div>
        </div>

        <!-- 【子页面 - 聊天总结】新增 -->
        <div class="sub-page" id="chat-summary-page">
            <div class="sub-nav">
                <div class="back-btn" data-back="chat-summary-page">
                    <svg class="icon-svg icon-svg-sm"><use href="#icon-arrow-left"></use></svg>
                </div>
                <div class="sub-title">聊天总结</div>
            </div>
            <div class="sub-content">
                <div class="placeholder-text">
                    【聊天总结功能开发中】<br><br>
                    计划功能：<br>
                    • AI自动总结对话内容<br>
                    • 关键信息提取<br>
                    • 对话历史归档<br>
                    • 记忆管理
                </div>
            </div>
        </div>

        <!-- 
            ============================================================
            【聊天页面】
            ============================================================
        -->
        <div class="chat-page" id="chat-page">
            <div class="chat-nav">
                <div class="back-btn" id="chat-back-btn">
                    <svg class="icon-svg icon-svg-sm"><use href="#icon-arrow-left"></use></svg>
                </div>
                <div class="chat-title" id="chat-title">AI小助手</div>
                <div class="chat-more">
                    <svg class="icon-svg"><use href="#icon-more"></use></svg>
                </div>
            </div>
            
            <div class="chat-messages" id="chat-messages">
                <div class="chat-bubble received">
                    <div class="chat-avatar">助</div>
                    <div class="chat-text">你好呀！我是AI小助手，有什么可以帮你的吗？😊</div>
                </div>
            </div>
            
            <div class="chat-input-area">
                <textarea class="chat-input" id="chat-input" placeholder="输入消息..." rows="1"></textarea>
                <button class="chat-send-btn" id="chat-send-btn">
                    <svg class="icon-svg"><use href="#icon-send"></use></svg>
                </button>
            </div>
        </div>

        <!-- 
            ============================================================
            【个性名片编辑页面】
            ============================================================
        -->
        <div class="card-edit-page" id="card-edit-page">
            <div class="sub-nav">
                <div class="back-btn" id="card-edit-back-btn">
                    <svg class="icon-svg icon-svg-sm"><use href="#icon-arrow-left"></use></svg>
                </div>
                <div class="sub-title">编辑资料</div>
            </div>
            <div class="sub-content" style="padding: 0; background-color: #f5f5f5;">
                <div class="edit-item" id="edit-avatar-btn">
                    <div class="edit-label">头像</div>
                    <div class="edit-value">
                        <div class="edit-avatar">薯</div>
                        <div class="edit-arrow"></div>
                    </div>
                </div>
                
                <div class="edit-item" id="edit-bg-btn">
                    <div class="edit-label">背景图</div>
                    <div class="edit-value">
                        <span>未设置</span>
                        <div class="edit-arrow"></div>
                    </div>
                </div>
                
                <div class="edit-item" id="edit-name-btn">
                    <div class="edit-label">昵称</div>
                    <div class="edit-value">
                        <span id="edit-name-value">薯片机用户</span>
                        <div class="edit-arrow"></div>
                    </div>
                </div>
                
                <div class="edit-item" id="edit-signature-btn">
                    <div class="edit-label">个性签名</div>
                    <div class="edit-value">
                        <span id="edit-signature-value">这个人很懒，什么都没写~</span>
                        <div class="edit-arrow"></div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- 
        ================================================================
        【JavaScript 交互逻辑】
        ================================================================
    -->
    <script>
        // 应用状态
        const AppState = {
            currentTab: 'msg-page',
            currentChat: null,
            sideMenuOpen: false,
            addPopupOpen: false,
            userData: {
                name: '薯片机用户',
                avatar: '薯',
                signature: '这个人很懒，什么都没写~'
            },
            apiConfig: {
                apiKey: '',
                apiUrl: 'https://api.openai.com/v1',
                model: 'gpt-3.5-turbo'
            }
        };

        // DOM元素缓存
        const DOM = {
            appContainer: document.getElementById('app-container'),
            topNav: document.getElementById('top-nav'),
            userInfo: document.getElementById('user-info'),
            addBtn: document.getElementById('add-btn'),
            addPopup: document.getElementById('add-popup'),
            sideMenu: document.getElementById('side-menu'),
            mask: document.getElementById('mask'),
            cardEditBtn: document.getElementById('card-edit-btn'),
            msgPage: document.getElementById('msg-page'),
            friendPage: document.getElementById('friend-page'),
            dynamicPage: document.getElementById('dynamic-page'),
            tabBar: document.getElementById('tab-bar'),
            chatPage: document.getElementById('chat-page'),
            chatTitle: document.getElementById('chat-title'),
            chatMessages: document.getElementById('chat-messages'),
            chatInput: document.getElementById('chat-input'),
            chatSendBtn: document.getElementById('chat-send-btn'),
            chatBackBtn: document.getElementById('chat-back-btn'),
            cardEditPage: document.getElementById('card-edit-page'),
            cardEditBackBtn: document.getElementById('card-edit-back-btn'),
            msgList: document.getElementById('msg-list')
        };

        // 底部标签栏切换
        function initTabBar() {
            const tabItems = DOM.tabBar.querySelectorAll('.tab-item');
            const mainContents = document.querySelectorAll('.main-content');
            
            tabItems.forEach(item => {
                item.addEventListener('click', () => {
                    const targetTab = item.dataset.tab;
                    
                    tabItems.forEach(tab => tab.classList.remove('active'));
                    item.classList.add('active');
                    
                    mainContents.forEach(content => content.classList.remove('active'));
                    document.getElementById(targetTab).classList.add('active');
                    
                    AppState.currentTab = targetTab;
                });
            });
        }

        // 侧边栏控制
        function initSideMenu() {
            DOM.userInfo.addEventListener('click', () => {
                openSideMenu();
            });
            
            DOM.mask.addEventListener('click', () => {
                closeSideMenu();
            });
            
            const menuItems = DOM.sideMenu.querySelectorAll('.menu-item');
            menuItems.forEach(item => {
                item.addEventListener('click', () => {
                    const func = item.dataset.func;
                    handleMenuClick(func);
                });
            });
            
            DOM.cardEditBtn.addEventListener('click', () => {
                closeSideMenu();
                openCardEditPage();
            });
        }
        
        function openSideMenu() {
            DOM.sideMenu.classList.add('open');
            DOM.mask.classList.add('show');
            AppState.sideMenuOpen = true;
        }
        
        function closeSideMenu() {
            DOM.sideMenu.classList.remove('open');
            DOM.mask.classList.remove('show');
            AppState.sideMenuOpen = false;
        }
        
        function handleMenuClick(func) {
            closeSideMenu();
            
            switch(func) {
                case 'wallet':
                    alert('钱包功能开发中...');
                    break;
                case 'collection':
                    alert('收藏功能开发中...');
                    break;
                case 'emoji':
                    alert('表情包功能开发中...');
                    break;
                case 'worldbook':
                    openSubPage('worldbook-page');
                    break;
                case 'decoration':
                    alert('个性装扮功能开发中...');
                    break;
                case 'api-settings':
                    openSubPage('api-settings-page');
                    break;
                case 'chat-summary':
                    openSubPage('chat-summary-page');
                    break;
                case 'settings':
                    alert('设置功能开发中...');
                    break;
            }
        }

        // 添加弹窗控制
        function initAddPopup() {
            DOM.addBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                toggleAddPopup();
            });
            
            document.addEventListener('click', (e) => {
                if (AppState.addPopupOpen && !DOM.addPopup.contains(e.target)) {
                    closeAddPopup();
                }
            });
            
            document.getElementById('add-friend-btn').addEventListener('click', () => {
                closeAddPopup();
                alert('添加AI好友功能开发中...');
            });
            
            document.getElementById('create-group-btn').addEventListener('click', () => {
                closeAddPopup();
                alert('创建AI群聊功能开发中...');
            });
            
            document.getElementById('scan-btn').addEventListener('click', () => {
                closeAddPopup();
                alert('扫一扫功能开发中...');
            });
        }
        
        function toggleAddPopup() {
            if (AppState.addPopupOpen) {
                closeAddPopup();
            } else {
                openAddPopup();
            }
        }
        
        function openAddPopup() {
            DOM.addPopup.classList.add('show');
            AppState.addPopupOpen = true;
        }
        
        function closeAddPopup() {
            DOM.addPopup.classList.remove('show');
            AppState.addPopupOpen = false;
        }

        // 好友分组展开/收起
        function initFriendGroups() {
            const groupHeaders = document.querySelectorAll('.group-header');
            
            groupHeaders.forEach(header => {
                header.addEventListener('click', (e) => {
                    if (e.target.classList.contains('group-edit')) {
                        alert('分组管理功能开发中...');
                        return;
                    }
                    
                    const groupName = header.dataset.group;
                    const friendList = document.querySelector(`.friend-list[data-group="${groupName}"]`);
                    
                    header.classList.toggle('collapsed');
                    friendList.classList.toggle('show');
                });
            });
            
            const friendItems = document.querySelectorAll('.friend-item');
            friendItems.forEach(item => {
                item.addEventListener('click', () => {
                    const friendId = item.dataset.friendId;
                    const friendName = item.querySelector('.friend-name').textContent;
                    openChat(friendId, friendName);
                });
            });
        }

        // 动态页功能入口
        function initDynamicPage() {
            const funcItems = document.querySelectorAll('.func-item');
            
            funcItems.forEach(item => {
                item.addEventListener('click', () => {
                    const pageId = item.dataset.page;
                    openSubPage(pageId);
                });
            });
            
            const backBtns = document.querySelectorAll('.sub-page .back-btn');
            backBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const pageId = btn.dataset.back;
                    closeSubPage(pageId);
                });
            });
        }
        
        function openSubPage(pageId) {
            const page = document.getElementById(page Id);
            if (page) {
                page.classList.add('open');
            }
        }
        
        function closeSubPage(pageId) {
            const page = document.getElementById(pageId);
            if (page) {
                page.classList.remove('open');
            }
        }

        // 消息列表点击进入聊天
        function initMsgList() {
            const msgItems = DOM.msgList.querySelectorAll('.msg-item');
            
            msgItems.forEach(item => {
                item.addEventListener('click', () => {
                    const chatId = item.dataset.chatId;
                    const chatName = item.dataset.chatName;
                    openChat(chatId, chatName);
                });
            });
        }

        // 聊天页面控制
        function initChatPage() {
            DOM.chatBackBtn.addEventListener('click', () => {
                closeChat();
            });
            
            DOM.chatSendBtn.addEventListener('click', () => {
                sendMessage();
            });
            
            DOM.chatInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
            
            // 自动调整输入框高度
            DOM.chatInput.addEventListener('input', () => {
                DOM.chatInput.style.height = 'auto';
                DOM.chatInput.style.height = Math.min(DOM.chatInput.scrollHeight, 120) + 'px';
            });
        }
        
        function openChat(chatId, chatName) {
            AppState.currentChat = { id: chatId, name: chatName };
            DOM.chatTitle.textContent = chatName;
            DOM.chatPage.classList.add('open');
            
            // 清空之前的消息，添加欢迎消息
            DOM.chatMessages.innerHTML = `
                <div class="chat-bubble received">
                    <div class="chat-avatar">${chatName.charAt(0)}</div>
                    <div class="chat-text">你好呀！我是${chatName}，很高兴见到你！😊</div>
                </div>
            `;
        }
        
        function closeChat() {
            DOM.chatPage.classList.remove('open');
            AppState.currentChat = null;
        }
        
        function sendMessage() {
            const message = DOM.chatInput.value.trim();
            if (!message) return;
            
            // 添加用户消息
            const userBubble = document.createElement('div');
            userBubble.className = 'chat-bubble sent';
            userBubble.innerHTML = `
                <div class="chat-avatar">${AppState.userData.avatar}</div>
                <div class="chat-text">${escapeHtml(message)}</div>
            `;
            DOM.chatMessages.appendChild(userBubble);
            
            // 清空输入框
            DOM.chatInput.value = '';
            DOM.chatInput.style.height = 'auto';
            
            // 滚动到底部
            DOM.chatMessages.scrollTop = DOM.chatMessages.scrollHeight;
            
            // 模拟AI回复
            setTimeout(() => {
                const aiBubble = document.createElement('div');
                aiBubble.className = 'chat-bubble received';
                aiBubble.innerHTML = `
                    <div class="chat-avatar">${AppState.currentChat.name.charAt(0)}</div>
                    <div class="chat-text">${getAIResponse(message)}</div>
                `;
                DOM.chatMessages.appendChild(aiBubble);
                DOM.chatMessages.scrollTop = DOM.chatMessages.scrollHeight;
            }, 800);
        }
        
        function getAIResponse(message) {
            const responses = [
                '这是一个很有趣的问题呢！让我想想... 🤔',
                '我明白你的意思了！我觉得这样挺好的~',
                '哈哈，你真有趣！我很喜欢和你聊天 😄',
                '嗯嗯，我在认真听你说呢！继续说吧~',
                '这个话题很有意思，我们可以深入聊聊！',
                '你说得对！我也是这么想的~'
            ];
            return responses[Math.floor(Math.random() * responses.length)];
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // 名片编辑页面
        function initCardEditPage() {
            DOM.cardEditBackBtn.addEventListener('click', () => {
                closeCardEditPage();
            });
            
            document.getElementById('edit-name-btn').addEventListener('click', () => {
                const newName = prompt('请输入新昵称：', AppState.userData.name);
                if (newName && newName.trim()) {
                    AppState.userData.name = newName.trim();
                    updateUserDisplay();
                }
            });
            
            document.getElementById('edit-signature-btn').addEventListener('click', () => {
                const newSignature = prompt('请输入个性签名：', AppState.userData.signature);
                if (newSignature !== null) {
                    AppState.userData.signature = newSignature.trim() || '这个人很懒，什么都没写~';
                    updateUserDisplay();
                }
            });
            
            document.getElementById('edit-avatar-btn').addEventListener('click', () => {
                alert('头像上传功能开发中...');
            });
            
            document.getElementById('edit-bg-btn').addEventListener('click', () => {
                alert('背景图设置功能开发中...');
            });
        }
        
        function openCardEditPage() {
            DOM.cardEditPage.classList.add('open');
        }
        
        function closeCardEditPage() {
            DOM.cardEditPage.classList.remove('open');
        }
        
        function updateUserDisplay() {
            // 更新顶部导航
            document.querySelector('.user-name').textContent = AppState.userData.name;
            document.querySelector('.user-avatar').textContent = AppState.userData.avatar;
            
            // 更新侧边栏
            document.querySelector('.card-name').textContent = AppState.userData.name;
            document.querySelector('.card-avatar').textContent = AppState.userData.avatar;
            document.querySelector('.card-signature').textContent = AppState.userData.signature;
            
            // 更新编辑页面
            document.getElementById('edit-name-value').textContent = AppState.userData.name;
            document.getElementById('edit-signature-value').textContent = AppState.userData.signature;
            document.querySelector('.edit-avatar').textContent = AppState.userData.avatar;
        }

        // 搜索功能
        function initSearch() {
            const searchInput = document.getElementById('search-input');
            
            searchInput.addEventListener('input', (e) => {
                const keyword = e.target.value.toLowerCase().trim();
                const msgItems = DOM.msgList.querySelectorAll('.msg-item');
                
                msgItems.forEach(item => {
                    const name = item.dataset.chatName.toLowerCase();
                    if (keyword === '' || name.includes(keyword)) {
                        item.style.display = 'flex';
                    } else {
                        item.style.display = 'none';
                    }
                });
            });
        }

        // 触摸滑动关闭侧边栏
        function initTouchGestures() {
            let startX = 0;
            let currentX = 0;
            let isDragging = false;
            
            DOM.sideMenu.addEventListener('touchstart', (e) => {
                startX = e.touches[0].clientX;
                isDragging = true;
            });
            
            DOM.sideMenu.addEventListener('touchmove', (e) => {
                if (!isDragging) return;
                currentX = e.touches[0].clientX;
                const diff = currentX - startX;
                
                if (diff < 0) {
                    DOM.sideMenu.style.transform = `translateX(${diff}px)`;
                }
            });
            
            DOM.sideMenu.addEventListener('touchend', () => {
                if (!isDragging) return;
                isDragging = false;
                
                const diff = currentX - startX;
                DOM.sideMenu.style.transform = '';
                
                if (diff < -80) {
                    closeSideMenu();
                }
            });
        }

        // 防止iOS橡皮筋效果
        function preventBounce() {
            document.body.addEventListener('touchmove', (e) => {
                if (e.target.closest('.chat-messages') || 
                    e.target.closest('.msg-list') || 
                    e.target.closest('.friend-page') ||
                    e.target.closest('.dynamic-page') ||
                    e.target.closest('.menu-list') ||
                    e.target.closest('.sub-content')) {
                    return;
                }
                e.preventDefault();
            }, { passive: false });
        }

        // 初始化应用
        function initApp() {
            initTabBar();
            initSideMenu();
            initAddPopup();
            initFriendGroups();
            initDynamicPage();
            initMsgList();
            initChatPage();
            initCardEditPage();
            initSearch();
            initTouchGestures();
            preventBounce();
            
            console.log('薯片机 App 初始化完成！');
        }

        // DOM加载完成后初始化
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
